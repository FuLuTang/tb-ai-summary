<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>AI Mail Summarizer 设置</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }

        h2 {
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="number"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }

        .actions {
            margin-top: 30px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            color: white;
            font-size: 14px;
            border-radius: 4px;
        }

        #saveBtn {
            background-color: #007bff;
        }

        #saveBtn:hover {
            background-color: #0056b3;
        }

        #clearBtn {
            background-color: #d32f2f;
        }

        #clearBtn:hover {
            background-color: #b71c1c;
        }

        .status {
            margin-top: 10px;
            padding: 10px;
            display: none;
            border-radius: 4px;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            display: block;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            display: block;
        }
    </style>
</head>

<body>
    <h2>AI Mail Summarizer 设置</h2>

    <div class="form-group">
        <label for="apiKey">API Key</label>
        <input type="password" id="apiKey" placeholder="sk-...">
    </div>

    <div class="form-group">
        <label for="apiUrl">API URL</label>
        <input type="text" id="apiUrl" placeholder="https://api.openai.com/v1/chat/completions">
    </div>

    <div class="form-group">
        <label for="model">Model Name</label>
        <input type="text" id="model" placeholder="gpt-4o-mini">
    </div>

    <div class="form-group">
        <label for="temperature">Temperature (0.0 - 2.0)</label>
        <input type="number" id="temperature" min="0" max="2" step="0.1" placeholder="0.2">
        <p style="font-size: 12px; color: #666;">
            控制 AI 的随机性。较低的值 (0.2) 更严谨，较高的值 (0.8) 更具创造性。
        </p>
    </div>

    <div class="form-group">
        <label for="maxRps">每秒请求上限 (RPS)</label>
        <input type="number" id="maxRps" min="1" max="50" placeholder="5">
        <p style="font-size: 12px; color: #666;">
            OpenAI 默认速率限制约为 5 req/s，可根据账号配额调整。批量请求会遵守此值。
        </p>
    </div>

    <div class="form-group">
        <label for="maxConcurrent">并发请求上限</label>
        <input type="number" id="maxConcurrent" min="1" max="20" placeholder="3">
        <p style="font-size: 12px; color: #666;">
            控制同时并发的请求数量，避免一次性发出过多请求导致失败或被限流。
        </p>
    </div>

    <div class="form-group">
        <label for="maxCache">最大缓存数量 (Max Cache Entries)</label>
        <input type="number" id="maxCache" min="1" max="100">
        <p style="font-size: 12px; color: #666;">
            设置缓存的邮件摘要数量。当超过此数量时，最早查看的摘要将被自动删除。
        </p>
    </div>

    <div class="form-group">
        <button id="saveBtn">保存设置</button>
        <button id="clearBtn" class="secondary">清空缓存</button>
    </div>
    <div id="status" class="status"></div>

    <div class="log-section" style="margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px;">
        <h3>运行日志</h3>
        <textarea id="logArea" readonly
            style="width: 100%; height: 200px; font-family: monospace; font-size: 9px; padding: 5px; border: 1px solid #ccc; resize: vertical;"></textarea>
    </div>

    <script src="options.js"></script>
</body>

</html>
